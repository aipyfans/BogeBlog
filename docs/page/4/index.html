<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />




<script data-ad-client="ca-pub-7376123380604387" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>











  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="静水流深" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="为了梦-追梦,我的英文名由此而来">
<meta property="og:type" content="website">
<meta property="og:title" content="静水流深">
<meta property="og:url" content="http://blog.lijunbo.com/page/4/index.html">
<meta property="og:site_name" content="静水流深">
<meta property="og:description" content="为了梦-追梦,我的英文名由此而来">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="静水流深">
<meta name="twitter:description" content="为了梦-追梦,我的英文名由此而来">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.lijunbo.com/page/4/"/>





  <title> 静水流深 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?4a874f383236eb548cfc14b4365008b8";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">静水流深</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">非淡泊无以明志，非宁静无以致远</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/11/contributors/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/11/contributors/" itemprop="url">
                  贡献者指南(Contributors Guide)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-11T11:11:11+08:00">
                2017-06-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/11/contributors/" class="leancloud_visitors" data-flag-title="贡献者指南(Contributors Guide)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="环境-Environment"><a href="#环境-Environment" class="headerlink" title="环境(Environment)"></a>环境(Environment)</h2><p>最初在macOS 10.12上开发了react navigation，其中使用 node 7+ 和 react-native v0.39+。发现不同环境中的问题时请提交issues。</p>
<h2 id="开发-Development"><a href="#开发-Development" class="headerlink" title="开发(Development)"></a>开发(Development)</h2><h3 id="Fork代码库"><a href="#Fork代码库" class="headerlink" title="Fork代码库"></a>Fork代码库</h3><ul>
<li><p>在Github 上 fork <a href="https://github.com/react-community/react-navigation" target="_blank" rel="noopener"><code>react-navigation</code></a></p>
</li>
<li><p>在终端中运行这些命令在本地下载并安装它</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/&lt;USERNAME&gt;/react-navigation.git</span><br><span class="line">cd react-navigation</span><br><span class="line">git remote add upstream https://github.com/react-community/react-navigation.git</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
<h3 id="运行示例应用程序"><a href="#运行示例应用程序" class="headerlink" title="运行示例应用程序"></a>运行示例应用程序</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd examples/NavigationPlayground</span><br><span class="line">npm install</span><br><span class="line">cd ../..</span><br><span class="line">npm start</span><br><span class="line"></span><br><span class="line"># 在一个单独的终端标签:</span><br><span class="line">npm run run-playground-android</span><br><span class="line"># 或:</span><br><span class="line">npm run run-playground-ios</span><br></pre></td></tr></table></figure>
<p>You can also simply run e.g. <code>react-native run-android</code> from within the example app directory (instead of <code>npm run run-playground-android</code> from the root <code>react-navigation</code> directory); both do the same thing.</p>
<p>你也可以在从示例应用程序目录简单地运行(e.g. <code>react-native run-android</code> )，而不是<code>npm run run-playground-android</code> 从<code>react-navigation</code>根目录;因为都做的是同样的事情。</p>
<h3 id="运行网站"><a href="#运行网站" class="headerlink" title="运行网站"></a>运行网站</h3><p>对于开发模式和实时重新加载：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd website</span><br><span class="line">npm install</span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<p>使用服务器渲染以生产模式运行网站：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run prod</span><br></pre></td></tr></table></figure>
<h3 id="运行测试和类型检查"><a href="#运行测试和类型检查" class="headerlink" title="运行测试和类型检查"></a>运行测试和类型检查</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jest</span><br><span class="line">flow</span><br></pre></td></tr></table></figure>
<p>您的更改必须测试通过，才能被接受和合并。</p>
<p>流程尚未传递，但您的代码应该被检查，我们期望您的更改不会引入任何错误。</p>
<h3 id="开发文档"><a href="#开发文档" class="headerlink" title="开发文档"></a>开发文档</h3><p>The docs are indexed in <a href="https://github.com/react-community/react-navigation/blob/master/website/src/App.js" target="_blank" rel="noopener">App.js</a>, where all the pages are declared alongside the titles. To test the docs, follow the above instructions for running the website. Changing existing markdown files should not require any testing.</p>
<p>The markdown from the <code>docs</code> folder gets generated and dumped into a json file as a part of the build step. To see updated docs appear in the website, re-run the build step by running <code>npm run build-docs</code> from the <code>react-navigation</code> root folder.</p>
<h2 id="提交文稿"><a href="#提交文稿" class="headerlink" title="提交文稿"></a>提交文稿</h2><h3 id="新视图或独特功能"><a href="#新视图或独特功能" class="headerlink" title="新视图或独特功能"></a>新视图或独特功能</h3><p>Often navigation needs are specific to certain apps. If your changes are unique to your app, you may want to fork the view or router that has changed. You can keep the source code in your app, or publish it on npm as a <code>react-navigation</code> compatible view or router.</p>
<p>This library is intended to include highly standard and generic navigation patterns.</p>
<h3 id="新视图或独特功能-1"><a href="#新视图或独特功能-1" class="headerlink" title="新视图或独特功能"></a>新视图或独特功能</h3><p>Before embarking on any major changes, please file an issue describing the suggested change and motivation. We may already have thought about it and we want to make sure we all are on the same page before starting on any big changes.</p>
<h3 id="新视图或独特功能-2"><a href="#新视图或独特功能-2" class="headerlink" title="新视图或独特功能"></a>新视图或独特功能</h3><p>Simple bug fixes are welcomed in pull requests! Please check for duplicate PRs before posting.</p>
<h4 id="在提交PR之前，确保与上游状态同步："><a href="#在提交PR之前，确保与上游状态同步：" class="headerlink" title="在提交PR之前，确保与上游状态同步："></a>在提交PR之前，确保与上游状态同步：</h4><ul>
<li><code>git fetch upstream</code></li>
<li><code>git rebase upstream/master</code></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/10/screen-tracking/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/10/screen-tracking/" itemprop="url">
                  屏幕跟踪和分析(Screen tracking and analytics)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-10T11:11:11+08:00">
                2017-06-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/10/screen-tracking/" class="leancloud_visitors" data-flag-title="屏幕跟踪和分析(Screen tracking and analytics)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>此示例显示如何进行屏幕跟踪并发送到Google Analytics（分析）。该方法可以适应任何其他移动分析SDK。</p>
<h3 id="屏幕跟踪-Screen-tracking"><a href="#屏幕跟踪-Screen-tracking" class="headerlink" title="屏幕跟踪(Screen tracking)"></a>屏幕跟踪(Screen tracking)</h3><p>使用内置导航容器时，可以使用 <code>onNavigationStateChange</code> 方法来跟踪屏幕。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; GoogleAnalyticsTracker &#125; <span class="keyword">from</span> <span class="string">'react-native-google-analytics-bridge'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从导航状态获取当前屏幕</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCurrentRouteName</span>(<span class="params">navigationState</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!navigationState) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> route = navigationState.routes[navigationState.index];</span><br><span class="line">  <span class="comment">// 潜入嵌套导航仪</span></span><br><span class="line">  <span class="keyword">if</span> (route.routes) &#123;</span><br><span class="line">    <span class="keyword">return</span> getCurrentRouteName(route);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> route.routeName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> AppNavigator = StackNavigator(AppRouteConfigs);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;AppNavigator</span><br><span class="line">    onNavigationStateChange=&#123;(prevState, currentState) =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> currentScreen = getCurrentRouteName(currentState);</span><br><span class="line">      <span class="keyword">const</span> prevScreen = getCurrentRouteName(prevState);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (prevScreen !== currentScreen) &#123;</span><br><span class="line">        <span class="comment">// 以下行使用Google Analytics（分析）跟踪器</span></span><br><span class="line">        <span class="comment">// 在此更改跟踪器以使用其他移动分析SDK</span></span><br><span class="line">        tracker.trackScreenView(currentScreen);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  /&gt;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h3 id="使用Redux进行屏幕跟踪-Screen-tracking-with-Redux"><a href="#使用Redux进行屏幕跟踪-Screen-tracking-with-Redux" class="headerlink" title="使用Redux进行屏幕跟踪(Screen tracking with Redux)"></a>使用Redux进行屏幕跟踪(Screen tracking with Redux)</h3><p>使用Redux时，我们可以编写一个Redux中间件来跟踪屏幕。为此，我们将从上一节重用 <code>getCurrentRouteName</code> </p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; GoogleAnalyticsTracker &#125; <span class="keyword">from</span> <span class="string">'react-native-google-analytics-bridge'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> tracker = <span class="keyword">new</span> GoogleAnalyticsTracker(GA_TRACKING_ID);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> screenTracking = <span class="function">(<span class="params">&#123; getState &#125;</span>) =&gt;</span> next =&gt; <span class="function">(<span class="params">action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    action.type !== NavigationActions.NAVIGATE</span><br><span class="line">    &amp;&amp; action.type !== NavigationActions.BACK</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> next(action);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> currentScreen = getCurrentRouteName(getState().navigation);</span><br><span class="line">  <span class="keyword">const</span> result = next(action);</span><br><span class="line">  <span class="keyword">const</span> nextScreen = getCurrentRouteName(getState().navigation);</span><br><span class="line">  <span class="keyword">if</span> (nextScreen !== currentScreen) &#123;</span><br><span class="line">    <span class="comment">// 以下行使用Google Analytics（分析）跟踪器</span></span><br><span class="line">    <span class="comment">// 在此更改跟踪器以使用其他移动分析SDK</span></span><br><span class="line">    tracker.trackScreenView(nextScreen);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> screenTracking;</span><br></pre></td></tr></table></figure>
<h3 id="创建-Redux-store-并应用上述中间件"><a href="#创建-Redux-store-并应用上述中间件" class="headerlink" title="创建 Redux store 并应用上述中间件"></a>创建 Redux store 并应用上述中间件</h3><p><code>screenTracking</code> 中间件可以在创建时应用于store。有关详细信息，请参阅<a href="Redux-Integration.md">Redux 集成</a>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = createStore(</span><br><span class="line">  combineReducers(&#123;</span><br><span class="line">    navigation: navigationReducer,</span><br><span class="line">    ...</span><br><span class="line">  &#125;),</span><br><span class="line">  applyMiddleware(</span><br><span class="line">    screenTracking,</span><br><span class="line">    ...</span><br><span class="line">    ),</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/09/deep-linking/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/09/deep-linking/" itemprop="url">
                  深度链接(Deep Linking)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-09T11:11:11+08:00">
                2017-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/09/deep-linking/" class="leancloud_visitors" data-flag-title="深度链接(Deep Linking)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在本指南中，我们将设置我们的应用程序来处理外部URI。我们先从<a href="http://blog.lijunbo.com/2017/05/27/guide-intro/">我们在入门指南中创建的SimpleApp开始</a>。</p>
<p>在这个例子中，我们希望像<code>mychat://chat/Taylor</code>这样的URI打开我们的应用程序，并直接链接到Taylor的聊天页面中。</p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>以前我们已经定义了一个这样的导航器：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SimpleApp = StackNavigator(&#123;</span><br><span class="line">  Home: &#123; <span class="attr">screen</span>: HomeScreen &#125;,</span><br><span class="line">  Chat: &#123; <span class="attr">screen</span>: ChatScreen &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>我们希望像 <code>chat/Taylor</code> 这样的路径使用 <code>user</code> 作为参数传递并链接到“Chat”屏幕。让我们重新配置我们的聊天屏幕， <code>path</code> 告诉路由器要匹配的相对路径，以及要提取的参数。这个路径规范将是 <code>chat/:user</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SimpleApp = StackNavigator(&#123;</span><br><span class="line">  Home: &#123; <span class="attr">screen</span>: HomeScreen &#125;,</span><br><span class="line">  Chat: &#123;</span><br><span class="line">    screen: ChatScreen,</span><br><span class="line">    path: <span class="string">'chat/:user'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="URI前缀"><a href="#URI前缀" class="headerlink" title="URI前缀"></a>URI前缀</h3><p>接下来，让我们配置我们的导航器，从应用程序的传入URI中提取路径。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> SimpleApp = StackNavigator(&#123;...&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在Android上，除了scheme之外，URI前缀通常包含一个host</span></span><br><span class="line"><span class="keyword">const</span> prefix = Platform.OS == <span class="string">'android'</span> ? <span class="string">'mychat://mychat/'</span> : <span class="string">'mychat://'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MainApp = <span class="function"><span class="params">()</span> =&gt;</span> &lt;SimpleApp uriPrefix=&#123;prefix&#125; /&gt;;</span><br></pre></td></tr></table></figure>
<h2 id="iOS"><a href="#iOS" class="headerlink" title="iOS"></a>iOS</h2><p>Let’s configure the native iOS app to open based on the <code>mychat://</code> URI scheme.</p>
<p>让我们根据 <code>mychat://</code> URI scheme来配置原生iOS应用程序并将其打开。</p>
<p>在 <code>SimpleApp/ios/SimpleApp/AppDelegate.m</code> 中:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 在文件顶部添加标题:</span><br><span class="line">#import &lt;React/RCTLinkingManager.h&gt;</span><br><span class="line"></span><br><span class="line">// 在上面添加`@end`:</span><br><span class="line">- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url</span><br><span class="line">  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation</span><br><span class="line">&#123;</span><br><span class="line">  return [RCTLinkingManager application:application openURL:url</span><br><span class="line">                      sourceApplication:sourceApplication annotation:annotation];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在Xcode中，在 <code>SimpleApp/ios/SimpleApp.xcodeproj</code>下中打开项目。在侧栏中选择项目，然后导航到信息选项卡。向下滚动到”URL Types” 并添加一个。在新的URL类型中，将标识符和url scheme设置为所需的url scheme。</p>
<p><img src="https://reactnavigation.org/assets/xcode-linking.png" alt="Xcode project info URL types with mychat added"></p>
<p>现在你可以按Xcode play，或在命令行重新构建：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native run-ios</span><br></pre></td></tr></table></figure>
<p>要测试模拟器上的URI，请运行以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xcrun simctl openurl booted mychat://chat/Taylor</span><br></pre></td></tr></table></figure>
<p>要测试实际设备上的URI，请打开Safari并键入 <code>mychat://chat/Taylor</code>.</p>
<h2 id="Android"><a href="#Android" class="headerlink" title="Android"></a>Android</h2><p>要在Android中配置外部链接，您可以在清单中创建新的意图。</p>
<p>在 <code>SimpleApp/android/app/src/main/AndroidManifest.xml</code> 中,在MainActivity条目中添加新的 <code>VIEW</code> 类型意图过滤器(<code>intent-filter</code>)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;intent-filter&gt;</span><br><span class="line">    &lt;action android:name=&quot;android.intent.action.VIEW&quot; /&gt;</span><br><span class="line">    &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;</span><br><span class="line">    &lt;category android:name=&quot;android.intent.category.BROWSABLE&quot; /&gt;</span><br><span class="line">    &lt;data android:scheme=&quot;mychat&quot;</span><br><span class="line">          android:host=&quot;mychat&quot; /&gt;</span><br><span class="line">&lt;/intent-filter&gt;</span><br></pre></td></tr></table></figure>
<p>现在，重新安装该应用程序：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native run-android</span><br></pre></td></tr></table></figure>
<p>To test the intent handling in Android, run the following:</p>
<p>要测试Android中的意图处理，请运行以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">adb shell am start -W -a android.intent.action.VIEW -d &quot;mychat://mychat/chat/Taylor&quot; com.simpleapp</span><br></pre></td></tr></table></figure>
<p><img src="https://reactnavigation.org/assets/examples/linking-android.png" alt=""><br><img src="https://reactnavigation.org/assets/examples/linking-iphone.png" alt=""></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/08/web-integration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/08/web-integration/" itemprop="url">
                  Web集成(Web Integration)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-08T11:11:11+08:00">
                2017-06-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/08/web-integration/" class="leancloud_visitors" data-flag-title="Web集成(Web Integration)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>React导航路由器可以在web上工作，并允许您与本机应用程序共享导航逻辑。目前在 <code>react-navigation</code> 中捆绑的视图目前只适用于React Native，但这可能会与面向未来的项目（如 <a href="https://github.com/lelandrichardson/react-primitives" target="_blank" rel="noopener">react-primitives</a>）发生变化。</p>
<h2 id="示例应用程序-Example-App"><a href="#示例应用程序-Example-App" class="headerlink" title="示例应用程序(Example App)"></a>示例应用程序(Example App)</h2><p><a href="https://reactnavigation.org/" target="_blank" rel="noopener">该网站</a>是使用React Navigation<a href="https://github.com/react-community/react-navigation/blob/master/website/" target="_blank" rel="noopener">构建</a>的，具体使用<code>createNavigator</code>和<code>TabRouter</code>。</p>
<p>在这里查看网站的源代码:<a href="https://github.com/react-community/react-navigation/blob/master/website/src/App.js" target="_blank" rel="noopener">App.js</a>.</p>
<p>要了解应用程序如何在服务器上呈现，请参阅<a href="https://github.com/react-community/react-navigation/blob/master/website/src/Server.js" target="_blank" rel="noopener">Server.js</a>。在浏览器上，App被唤醒并使用<a href="https://github.com/react-community/react-navigation/blob/master/website/src/BrowserAppContainer.js" target="_blank" rel="noopener">BrowserAppContainer.js</a>渲染。</p>
<h2 id="更多即将推出-More-Coming-Soon"><a href="#更多即将推出-More-Coming-Soon" class="headerlink" title="更多即将推出(More Coming Soon)"></a>更多即将推出(More Coming Soon)</h2><p>不久之后，本指南将被Web上的react-navigation使用的更彻底的演练所取代。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/07/redux-Integration/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/07/redux-Integration/" itemprop="url">
                  Redux集成(Redux Integration)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-07T11:11:11+08:00">
                2017-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/07/redux-Integration/" class="leancloud_visitors" data-flag-title="Redux集成(Redux Integration)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>要在redux中处理您的应用程序的导航状态，您可以将自己的导航(<code>navigation</code>)属性传递给导航器。您的导航属性必须提供当前状态，以及访问分发者(dispatcher)来处理导航选项。</p>
<p>使用redux，您的应用程序的状态由reducer定义。每个导航路由器实际上都有一个reducer，调用<code>getStateForAction</code>。以下是在redux应用程序中如何使用导航器的小示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">import &#123; addNavigationHelpers &#125; from &apos;react-navigation&apos;;</span><br><span class="line"></span><br><span class="line">const AppNavigator = StackNavigator(AppRouteConfigs);</span><br><span class="line"></span><br><span class="line">const initialState = AppNavigator.router.getStateForAction(AppNavigator.router.getActionForPathAndParams(&apos;Login&apos;));</span><br><span class="line"></span><br><span class="line">const navReducer = (state = initialState, action) =&gt; &#123;</span><br><span class="line">  const nextState = AppNavigator.router.getStateForAction(action, state);</span><br><span class="line"></span><br><span class="line">  // 简单实现：如果`nextState`为null或未定义，则返回原来的`state`.</span><br><span class="line">  return nextState || state;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const appReducer = combineReducers(&#123;</span><br><span class="line">  nav: navReducer,</span><br><span class="line">  ...</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">class App extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;AppNavigator navigation=&#123;addNavigationHelpers(&#123;</span><br><span class="line">        dispatch: this.props.dispatch,</span><br><span class="line">        state: this.props.nav,</span><br><span class="line">      &#125;)&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const mapStateToProps = (state) =&gt; (&#123;</span><br><span class="line">  nav: state.nav</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">const AppWithNavigationState = connect(mapStateToProps)(App);</span><br><span class="line"></span><br><span class="line">const store = createStore(appReducer);</span><br><span class="line"></span><br><span class="line">class Root extends React.Component &#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    return (</span><br><span class="line">      &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt;AppWithNavigationState /&gt;</span><br><span class="line">      &lt;/Provider&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一旦你这样做，你的导航状态被存储在您的redux store中，在那时你可以使用redux的分发(dispatch)函数来发送导航动作。</p>
<p>请记住，当导航器获得导航属性时，它放弃对其内部状态的控制。这意味着您现在有责任维护好原有的状态，处理任何深链接，集成后退按钮等。</p>
<p>当您嵌套它们时，导航状态将自动从一个导航器传递到另一个导航器。请注意，为了使子导航器从父导航器接收状态，应将其定义为屏幕(<code>screen</code>)。</p>
<p>将其应用于上述示例，您可以将<code>AppNavigator</code>定义为包含嵌套的<code>TabNavigator</code>，如下所示：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> AppNavigator = StackNavigator(&#123;</span><br><span class="line">  Home: &#123; <span class="attr">screen</span>: MyTabNavigator &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在这种情况下，在<code>AppWithNavigationState</code>中一旦将<code>AppNavigator</code>连接( <code>connect</code> )到<code>Redux</code>完成时，<code>MyTabNavigator</code>将作为导航属性( <code>navigation</code> prop)自动进入导航状态。</p>
<h2 id="完整的例子-Full-example"><a href="#完整的例子-Full-example" class="headerlink" title="完整的例子(Full example)"></a>完整的例子(Full example)</h2><p>如果你想自己尝试，这里( <a href="https://github.com/react-community/react-navigation/tree/master/examples/ReduxExample" target="_blank" rel="noopener">here</a> )有一个有redux的工作示例应用程序。</p>
<h2 id="模拟测试-Mocking-tests"><a href="#模拟测试-Mocking-tests" class="headerlink" title="模拟测试(Mocking tests)"></a>模拟测试(Mocking tests)</h2><p>为了使您的react-navigation应用程序可以进行测试，您需要更改package.json中的<code>jest preset</code>，请参阅：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&quot;jest&quot;: &#123;</span><br><span class="line">  &quot;preset&quot;: &quot;react-native&quot;,</span><br><span class="line">  &quot;transformIgnorePatterns&quot;: [</span><br><span class="line">    &quot;node_modules/(?!(jest-)?react-native|react-navigation)&quot;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/06/custom-navigators/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/06/custom-navigators/" itemprop="url">
                  自定义导航器(Custom Navigators)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-06T11:11:11+08:00">
                2017-06-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/06/custom-navigators/" class="leancloud_visitors" data-flag-title="自定义导航器(Custom Navigators)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>导航器是具有一个路由器( <a href="/docs/routers/">router</a> )的React组件。下面是一个基本的导航器，它使用路由器的API( <a href="/docs/routers/api">router’s API</a> )来获取活动组件进行渲染：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNavigator</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> router = MyRouter;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; state, dispatch &#125; = <span class="keyword">this</span>.props.navigation;</span><br><span class="line">    <span class="keyword">const</span> &#123; routes, index &#125; = state;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 路由器根据导航状态找出要渲染的内容：</span></span><br><span class="line">    <span class="keyword">const</span> Component = MyRouter.getComponentForState(state);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 活动子屏幕的状态可以在routes [index]</span></span><br><span class="line">    <span class="keyword">let</span> childNavigation = &#123; dispatch, <span class="attr">state</span>: routes[index] &#125;;</span><br><span class="line">    <span class="comment">// 如果我们想要，我们也可以修改这里的分发功能来限制或增加我们孩子的行为</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 假设我们的子屏幕想要方便地调用.navigate（）</span></span><br><span class="line">    <span class="comment">// 我们应该调用addNavigationHelpers来增强我们的导航属性(navigation prop)：</span></span><br><span class="line">    childNavigation = addNavigationHelpers(childNavigation);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Component</span> <span class="attr">navigation</span>=<span class="string">&#123;childNavigation&#125;</span> /&gt;</span>;</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="导航属性-Navigation-Prop"><a href="#导航属性-Navigation-Prop" class="headerlink" title="导航属性(Navigation Prop)"></a>导航属性(Navigation Prop)</h2><p>传递给导航器的导航属性(navigation prop)只包括状态( <code>state</code>) 和分发( <code>dispatch</code>)。这是导航器的当前状态，以及发送动作请求的事件通道。</p>
<p>所有导航器都是受控组件：它们总是显示通过<code>props.navigation.state</code>进入的内容，而他们改变状态的唯一方法是将动作发送到<code>props.navigation.dispatch</code>中。</p>
<p>导航器可以通过自定义路由器( <a href="/docs/routers/">customizing their router</a>)来指定父导航器的自定义行为。例如，导航器能够通过从<code>router.getStateForAction</code>返回null来指定应该何时阻止执行动作。或者导航器可以通过重写<code>router.getActionForPathAndParams</code>来指定自定义URI处理，以输出相关的导航动作，并在<code>router.getStateForAction</code>中处理该动作。</p>
<h3 id="导航状态-Navigation-State"><a href="#导航状态-Navigation-State" class="headerlink" title="导航状态(Navigation State)"></a>导航状态(Navigation State)</h3><p>传递到导航器的<code>props.navigation.state</code>的导航状态具有以下结构：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  index: 1, // 识别路由数组中的哪个路由是活动的</span><br><span class="line">  routes: [</span><br><span class="line">    &#123;</span><br><span class="line">      // 每个路由都需要一个名称，路由器将用于将每个路由与一个React组件相关联</span><br><span class="line">      routeName: &apos;MyRouteName&apos;,</span><br><span class="line"></span><br><span class="line">      // 此路由的唯一ID，用于在路由数组中保持顺序：</span><br><span class="line">      key: &apos;myroute-123&apos;,</span><br><span class="line"></span><br><span class="line">      // 路由可以有任何其他数据。包含路由器有的`params`</span><br><span class="line">      ...customRouteData,</span><br><span class="line">    &#125;,</span><br><span class="line">    ...moreRoutes,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="导航分发-Navigation-Dispatchers"><a href="#导航分发-Navigation-Dispatchers" class="headerlink" title="导航分发(Navigation Dispatchers)"></a>导航分发(Navigation Dispatchers)</h3><p>导航器可以发送导航动作，例如“转到URI”( ‘Go to a URI’)，“返回”(‘Go back’)。</p>
<p>如果动作成功处理，分发者将返回true，否则返回false。</p>
<h2 id="用于构建自定义导航器的API"><a href="#用于构建自定义导航器的API" class="headerlink" title="用于构建自定义导航器的API"></a>用于构建自定义导航器的API</h2><p>为了帮助开发人员实现自定义导航器，React Navigation提供了以下实用函数：</p>
<h3 id="createNavigator"><a href="#createNavigator" class="headerlink" title="createNavigator"></a><code>createNavigator</code></h3><p>该实用函数以标准方式将路由器( <a href="/docs/routers/">router</a> )和导航视图( <a href="/docs/views/">navigation view</a> )组合在一起：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyApp = createNavigator(MyRouter)(MyView);</span><br></pre></td></tr></table></figure>
<p>所有这一切在幕后是：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyApp = <span class="function">(<span class="params">&#123; navigation &#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;MyView router=&#123;MyRouter&#125; navigation=&#123;navigation&#125; /&gt;</span><br><span class="line">);</span><br><span class="line">MyApp.router = MyRouter;</span><br></pre></td></tr></table></figure>
<h3 id="addNavigationHelpers"><a href="#addNavigationHelpers" class="headerlink" title="addNavigationHelpers"></a><code>addNavigationHelpers</code></h3><p>进入一个使用状态( <code>state</code> )和分发(<code>dispatch</code> )的裸导航器导航属性，并使用【屏幕导航属性中的所有各种函数如 <code>navigation.navigate()</code> 和<code>navigation.goBack()</code>】增强它。这些功能只是帮助人员创建动作并将其发送到<code>dispatch</code>。</p>
<h3 id="createNavigationContainer"><a href="#createNavigationContainer" class="headerlink" title="createNavigationContainer"></a><code>createNavigationContainer</code></h3><p>如果您希望导航器可用作顶级组件，（没有导航属性被传入），你可以使用<code>createNavigationContainer</code>。当导航属性丢失时，此实用函数将使您的导航器像顶级导航器。它将管理应用程序状态，并与应用程序级别的导航功能集成，如处理传入和传出链接以及Android返回按钮行为。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/05/screen-nav-options/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/05/screen-nav-options/" itemprop="url">
                  屏幕导航选项(Screen Navigation Options)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-05T11:11:11+08:00">
                2017-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/05/screen-nav-options/" class="leancloud_visitors" data-flag-title="屏幕导航选项(Screen Navigation Options)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>每个屏幕可以配置关于如何在父导航器中呈现的几个方面。</p>
<h4 id="两种方式来指定每个选项"><a href="#两种方式来指定每个选项" class="headerlink" title="两种方式来指定每个选项"></a>两种方式来指定每个选项</h4><p><strong>静态配置(Static configuration):</strong> 每个导航选项都可以直接分配：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = &#123;</span><br><span class="line">    title: <span class="string">'Great'</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p><strong>动态配置(Dynamic Configuration)</strong></p>
<p>或者，选项可以是一个接受以下参数的函数，并返回导航选项的对象，该对象将覆盖路由定义和导航器定义的<code>navigationOptions</code>。</p>
<ul>
<li><code>props</code> - 可用于屏幕组件的共同的属性<ul>
<li><code>navigation</code> -屏幕的导航属性( <a href="/docs/navigators/navigation-prop">navigation prop</a>)，和在<code>navigation.state</code>里的屏幕路由</li>
<li><code>screenProps</code> - 从导航器组件上传递过来的属性</li>
<li><code>navigationOptions</code> - 未提供新值时将使用的默认或先前设置的选项</li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = <span class="function">(<span class="params">&#123; navigation, screenProps &#125;</span>) =&gt;</span> (&#123;</span><br><span class="line">    title: navigation.state.params.name + <span class="string">"'s Profile!"</span>,</span><br><span class="line">    headerRight: <span class="xml"><span class="tag">&lt;<span class="name">Button</span> <span class="attr">color</span>=<span class="string">&#123;screenProps.tintColor&#125;</span> &#123;<span class="attr">...</span>&#125; /&gt;</span>,</span></span><br><span class="line"><span class="xml">  &#125;);</span></span><br><span class="line"><span class="xml">  ...</span></span><br></pre></td></tr></table></figure>
<p><code>screenProps</code>在渲染时传入。如果此屏幕托管在<code>SimpleApp</code>导航器中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;SimpleApp</span><br><span class="line">  screenProps=&#123;&#123;<span class="attr">tintColor</span>: <span class="string">'blue'</span>&#125;&#125;</span><br><span class="line">  <span class="comment">// navigation=&#123;&#123;state, dispatch&#125;&#125; // optionally control the app</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h4 id="通用导航选项-Generic-Navigation-Options"><a href="#通用导航选项-Generic-Navigation-Options" class="headerlink" title="通用导航选项(Generic Navigation Options)"></a>通用导航选项(Generic Navigation Options)</h4><p>标题 <code>title</code> 导航选项在每个导航器之间是通用的。它用于设置给定屏幕的标题字符串。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = &#123;</span><br><span class="line">    title: <span class="string">'Great'</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  ...</span><br></pre></td></tr></table></figure>
<p>与导航器视图仅使用的其他导航选项不同，环境中可以使用标题选项来更新浏览器窗口或应用程序切换器中的标题。</p>
<h4 id="默认导航选项-Default-Navigation-Options"><a href="#默认导航选项-Default-Navigation-Options" class="headerlink" title="默认导航选项(Default Navigation Options)"></a>默认导航选项(Default Navigation Options)</h4><p>在屏幕上定义<code>navigationOptions</code>是非常常见的，但有时也可以在导航器上定义navigationOptions也很有用</p>
<p>想象下面的情况：您的<code>TabNavigator</code>表示应用程序中的一个屏幕，并嵌套在顶级<code>StackNavigator</code>中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">StackNavigator(&#123;</span><br><span class="line">  route1: &#123; screen: RouteOne &#125;,</span><br><span class="line">  route2: &#123; screen: MyTabNavigator &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>现在，当<code>route2</code>处于活动状态时，您想更改标题的色调颜色。对于<code>route1</code>来说很容易做到，对于route2也是很容易的。这是默认导航选项 - 它们只是在导航器上设置的导航选项：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> MyTabNavigator = TabNavigator(&#123;</span><br><span class="line">  profile: ProfileScreen,</span><br><span class="line">  ...</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  navigationOptions: &#123;</span><br><span class="line">    headerTintColor: <span class="string">'blue'</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>请注意，您仍然可以决定在叶级别的屏幕上指定<code>navigationOptions</code>。上面的<code>ProfileScreen</code>屏幕上的<code>navigationOptions</code>将逐个合并到导航器的默认选项。无论什么时候导航器和屏幕都定义和相同的选项（例如<code>headerTintColor</code>），屏幕将会覆盖导航器的<code>navigationOptions</code>。因此，通过执行以下操作，您可以在<code>ProfileScreen</code>处于活动状态时更改色彩：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = &#123;</span><br><span class="line">    headerTintColor: <span class="string">'black'</span>,</span><br><span class="line">  &#125;;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="导航选项参考-Navigation-Option-Reference"><a href="#导航选项参考-Navigation-Option-Reference" class="headerlink" title="导航选项参考(Navigation Option Reference)"></a>导航选项参考(Navigation Option Reference)</h2><p>可用的导航选项列表取决依赖于添加屏幕的导航器。</p>
<p>检查以下可用选项：</p>
<ul>
<li><a href="/docs/api/navigators/DrawerNavigator.md#screen-navigation-options"><code>drawer navigator</code></a></li>
<li><a href="/docs/api/navigators/StackNavigator.md#screen-navigation-options"><code>stack navigator</code></a></li>
<li><a href="/docs/api/navigators/TabNavigator.md#screen-navigation-options"><code>tab navigator</code></a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/04/navigation-actions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/04/navigation-actions/" itemprop="url">
                  导航动作(Navigation Actions)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-04T11:11:11+08:00">
                2017-06-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/04/navigation-actions/" class="leancloud_visitors" data-flag-title="导航动作(Navigation Actions)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>所有导航动作返回【可以使用<code>navigation.dispatch（）</code>方法发送到路由器】的对象。</p>
<p>请注意，如果要发送(dispatch) react-navigation动作，则应使用此库中提供的动作创建者(action creators)。</p>
<p>支持以下操作：</p>
<ul>
<li><a href="#Navigate">Navigate</a> - 导航到另一个路由</li>
<li><a href="#Reset">Reset</a> - 使用新状态替换当前状态</li>
<li><a href="#Back">Back</a> - 返回上一个状态</li>
<li><a href="#SetParams">Set Params</a> - 给指定的路由设置参数</li>
<li><a href="#Init">Init</a> - 如果状态未定义，则使用初始化的第一个状态</li>
</ul>
<h3 id="导航-Navigate"><a href="#导航-Navigate" class="headerlink" title="导航(Navigate)"></a>导航(Navigate)</h3><p>导航(Navigate)动作将通过导航(Navigate)动作的结果更新当前状态。</p>
<ul>
<li><code>routeName</code> - <em>String</em>  - 必需 - 已在应用程序的路由器中某处注册的目标routeName</li>
<li><code>params</code> - <em>Object</em> - 可选 - 将参数合并到目标路由中</li>
<li><code>action</code> - <em>Object</em> - 可选 - （高级）如果屏幕是导航器，则在子路由器中运行的子操作。本文档中描述的任何一个操作都可以设置为子操作。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> navigateAction = NavigationActions.navigate(&#123;</span><br><span class="line"></span><br><span class="line">  routeName: <span class="string">'Profile'</span>,</span><br><span class="line"></span><br><span class="line">  params: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  action: NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'SubProfileRoute'</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(navigateAction)</span><br></pre></td></tr></table></figure>
<h3 id="复位-Reset"><a href="#复位-Reset" class="headerlink" title="复位(Reset)"></a>复位(Reset)</h3><p>复位 <code>Reset</code> 动作会擦除整个导航状态，并将其替换为多个动作的结果</p>
<ul>
<li><code>index</code> - <em>number</em> - required - 在导航状态的路由数组上的活动路由索引.</li>
<li><code>actions</code> - <em>array</em> - required - 导航动作的阵列将取代导航状态.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resetAction = NavigationActions.reset(&#123;</span><br><span class="line">  index: <span class="number">0</span>,</span><br><span class="line">  actions: [</span><br><span class="line">    NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'Profile'</span>&#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(resetAction)</span><br></pre></td></tr></table></figure>
<h4 id="如何使用索引-index-参数"><a href="#如何使用索引-index-参数" class="headerlink" title="如何使用索引 index 参数"></a>如何使用索引 <code>index</code> 参数</h4><p>索引 <code>index</code> 参数用于指定当前的活动路由。</p>
<p>例如：给定一个使用两个路由配置的（<code>Profile</code>和<code>Settings</code>）基本的堆栈导航。要将状态重置为活动屏幕为<code>Settings</code>但将其堆叠在<code>Profile</code>屏幕顶部的位置，则可以执行以下操作：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> resetAction = NavigationActions.reset(&#123;</span><br><span class="line">  index: <span class="number">1</span>,</span><br><span class="line">  actions: [</span><br><span class="line">    NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'Profile'</span>&#125;),</span><br><span class="line">    NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'Settings'</span>&#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(resetAction)</span><br></pre></td></tr></table></figure>
<h3 id="返回-Back"><a href="#返回-Back" class="headerlink" title="返回(Back)"></a>返回(Back)</h3><p>返回上一屏幕并关闭当前屏幕。返回( <code>back</code> )动作创建者具有一个可选参数：</p>
<ul>
<li><code>key</code> - <em>string or null</em> - 可选 - 如果设置，导航将从给定的键返回。如果为空，导航将返回任何地方.</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> backAction = NavigationActions.back(&#123;</span><br><span class="line">  key: <span class="string">'Profile'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(backAction)</span><br></pre></td></tr></table></figure>
<h3 id="设置参数-SetParams"><a href="#设置参数-SetParams" class="headerlink" title="设置参数(SetParams)"></a>设置参数(SetParams)</h3><p>当发送<code>SetParams</code>动作时，路由器将产生一个新的状态，该状态改变了特定路由的参数，由密钥标识</p>
<ul>
<li><code>params</code> - <em>object</em> - required - 新的参数将被合并到现有的路由参数中</li>
<li><code>key</code> - <em>string</em> - required - 路由密钥应该得到新的参数</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> setParamsAction = NavigationActions.setParams(&#123;</span><br><span class="line">  params: &#123; <span class="attr">title</span>: <span class="string">'Hello'</span> &#125;,</span><br><span class="line">  key: <span class="string">'screen-123'</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(setParamsAction)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/03/screen-navigation-prop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/03/screen-navigation-prop/" itemprop="url">
                  屏幕导航属性(Screen Navigation Prop)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-03T11:11:11+08:00">
                2017-06-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/03/screen-navigation-prop/" class="leancloud_visitors" data-flag-title="屏幕导航属性(Screen Navigation Prop)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>您应用中的每个屏幕都会收到一个包含以下内容的导航属性(navigation prop)：</p>
<ul>
<li><code>navigate</code> - (helper) 链接到其他屏幕</li>
<li><code>state</code> - 屏幕的当前状态/路由</li>
<li><code>setParams</code> - (helper) 更改路由的参数</li>
<li><code>goBack</code> - (helper) 关闭活动屏幕并返回</li>
<li><code>dispatch</code> - 向路由器发送动作(action)</li>
</ul>
<p>注意：<code>navigation</code> prop传递到每个导航感知组件，包括导航器。一个很大的例外是导航器的<code>navigation</code> prop可能没有辅助功能（navigate，goBack等）;它可能只有 <code>state</code> 和 <code>dispatch</code> 。为了 <code>navigate</code> 使用导航器的<code>navigation</code> prop，您将不得不使用动作创建者(action creator)进行调度(<code>dispatch</code>).</p>
<p><em>关于与Redux挂钩的注意事项</em></p>
<blockquote>
<p>人们并不总是使用Redux正确地勾勒出来，因为他们误解导航器的顶级API，导航属性( navigation prop)是可选的。如果导航器没有获得导航属性( navigation prop)，导航器将保持其状态，但这并不是您通过使用redux挂起应用程序时通常希望使用的功能。对于嵌套在主导航器中的导航器，您总是希望通过屏幕的导航属性( navigation prop)往下传递。这允许您的根导航器与所有子导航器通信并提供状态。只有您的根路由器需要与redux集成，因为所有其他路由器都在其中。</p>
</blockquote>
<h2 id="navigate-链接到其他屏幕"><a href="#navigate-链接到其他屏幕" class="headerlink" title="navigate - 链接到其他屏幕"></a><code>navigate</code> - 链接到其他屏幕</h2><p>Call this to link to another screen in your app. Takes the following arguments:</p>
<p>调用此函数链接到您应用中的另一个屏幕。获得以下参数：</p>
<p><code>navigate(routeName, params, action)</code></p>
<ul>
<li><code>routeName</code> - 已经在应用程序路由器中某处注册的目标routeName</li>
<li><code>params</code> - 参数合并到目的地路由</li>
<li><code>action</code> - （高级）在子路由器中运行的子操作，如果屏幕是导航器。有关支持的操作的完整列表，请参阅操作文档。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;navigate&#125; = <span class="keyword">this</span>.props.navigation;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View&gt;</span><br><span class="line">        &lt;Text&gt;This is the home screen <span class="keyword">of</span> the app&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">        &lt;Button</span></span><br><span class="line"><span class="regexp">          onPress=&#123;() =&gt; navigate('Profile', &#123;name: 'Brent'&#125;)&#125;</span></span><br><span class="line"><span class="regexp">          title="Go to Brent's profile"</span></span><br><span class="line"><span class="regexp">        /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">     )</span></span><br><span class="line"><span class="regexp">   &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="state-屏幕的当前状态-路由"><a href="#state-屏幕的当前状态-路由" class="headerlink" title="state - 屏幕的当前状态/路由"></a><code>state</code> - 屏幕的当前状态/路由</h2><p>屏幕可以通过<code>this.props.navigation.state</code>访问其路由。每个都将返回一个具有以下内容的对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 路由器中配置的路由名称</span></span><br><span class="line">  routeName: <span class="string">'profile'</span>,</span><br><span class="line">  <span class="comment">// 用于对路由进行排序的唯一标识符</span></span><br><span class="line">  key: <span class="string">'main0'</span>,</span><br><span class="line">  <span class="comment">//此屏幕的字符串选项的可选对象</span></span><br><span class="line">  params: &#123; <span class="attr">hello</span>: <span class="string">'world'</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;state&#125; = <span class="keyword">this</span>.props.navigation;</span><br><span class="line">    <span class="comment">// state.routeName === 'Profile'</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Text&gt;Name: &#123;state.params.name&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="setParams-更改路由参数"><a href="#setParams-更改路由参数" class="headerlink" title="setParams - 更改路由参数"></a><code>setParams</code> - 更改路由参数</h2><p>启动<code>setParams</code>操作允许屏幕(组件)更改路由中的参数，这对于更新按钮和标题很有用。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;setParams&#125; = <span class="keyword">this</span>.props.navigation;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Button</span><br><span class="line">        onPress=&#123;() =&gt; setParams(&#123;<span class="attr">name</span>: <span class="string">'Lucy'</span>&#125;)&#125;</span><br><span class="line">        title=<span class="string">"Set title name to 'Lucy'"</span></span><br><span class="line">      /&gt;</span><br><span class="line">     )</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="goBack-关闭活动的屏幕并返回"><a href="#goBack-关闭活动的屏幕并返回" class="headerlink" title="goBack - 关闭活动的屏幕并返回"></a><code>goBack</code> - 关闭活动的屏幕并返回</h2><p>(可选)提供一个键，它指定要从中返回的路由。默认情况下，<code>goBack</code>将关闭调用它的路由。如果目标是回到任何地方，不用指定要关闭的路由，请调用<code>.goBack（null）</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123;goBack&#125; = <span class="keyword">this</span>.props.navigation;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;View&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">          onPress=&#123;() =&gt; goBack()&#125;</span><br><span class="line">          title=<span class="string">"Go back from this HomeScreen"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">          onPress=&#123;() =&gt; goBack(<span class="literal">null</span>)&#125;</span><br><span class="line">          title=<span class="string">"Go back anywhere"</span></span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;Button</span><br><span class="line">          onPress=&#123;() =&gt; goBack(<span class="string">'screen-123'</span>)&#125;</span><br><span class="line">          title=<span class="string">"Go back from screen-123"</span></span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">     )</span></span><br><span class="line"><span class="regexp">   &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="dispatch-发送一个动作-action-到路由器-router"><a href="#dispatch-发送一个动作-action-到路由器-router" class="headerlink" title="dispatch - 发送一个动作(action)到路由器(router)"></a><code>dispatch</code> - 发送一个动作(action)到路由器(router)</h2><p>使用dispatch向路由器发送任何导航动作(navigation action)。其他导航功能在幕后使用分发(dispatch)。</p>
<p>请注意，如果要发送react-navigation动作，则应使用此库中提供的动作创建者(action creators)。</p>
<p>有关可用动作的完整列表，请参阅导航动作文档( <a href="navigation-actions">Navigation Actions Docs</a> )。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> navigateAction = NavigationActions.navigate(&#123;</span><br><span class="line">  routeName: <span class="string">'Profile'</span>,</span><br><span class="line">  params: &#123;&#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// navigate can have a nested navigate action that will be run inside the child router</span></span><br><span class="line">  action: NavigationActions.navigate(&#123; <span class="attr">routeName</span>: <span class="string">'SubProfileRoute'</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">this</span>.props.navigation.dispatch(navigateAction)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.lijunbo.com/2017/06/02/drawer-navigator/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="William-Dream">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="静水流深">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/06/02/drawer-navigator/" itemprop="url">
                  抽屉导航器(DrawerNavigator)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-02T11:11:11+08:00">
                2017-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/react-navigation/" itemprop="url" rel="index">
                    <span itemprop="name">react navigation</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2017/06/02/drawer-navigator/" class="leancloud_visitors" data-flag-title="抽屉导航器(DrawerNavigator)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>用于轻松设置带抽屉导航的屏幕。有关实例，请参阅我们的展示Demo( <a href="https://exp.host/@react-navigation/NavigationPlayground" target="_blank" rel="noopener">our expo demo</a>)。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyHomeScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = &#123;</span><br><span class="line">    drawerLabel: <span class="string">'Home'</span>,</span><br><span class="line">    drawerIcon: <span class="function">(<span class="params">&#123; tintColor &#125;</span>) =&gt;</span> (</span><br><span class="line">      &lt;Image</span><br><span class="line">        source=&#123;<span class="built_in">require</span>(<span class="string">'./chats-icon.png'</span>)&#125;</span><br><span class="line">        style=&#123;[styles.icon, &#123;<span class="attr">tintColor</span>: tintColor&#125;]&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    ),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Button</span><br><span class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.navigate(<span class="string">'Notifications'</span>)&#125;</span><br><span class="line">        title=<span class="string">"Go to notifications"</span></span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyNotificationsScreen</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">static</span> navigationOptions = &#123;</span><br><span class="line">    drawerLabel: <span class="string">'Notifications'</span>,</span><br><span class="line">    drawerIcon: <span class="function">(<span class="params">&#123; tintColor &#125;</span>) =&gt;</span> (</span><br><span class="line">      &lt;Image</span><br><span class="line">        source=&#123;<span class="built_in">require</span>(<span class="string">'./notif-icon.png'</span>)&#125;</span><br><span class="line">        style=&#123;[styles.icon, &#123;<span class="attr">tintColor</span>: tintColor&#125;]&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    ),</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;Button</span><br><span class="line">        onPress=&#123;() =&gt; <span class="keyword">this</span>.props.navigation.goBack()&#125;</span><br><span class="line">        title=<span class="string">"Go back home"</span></span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> styles = StyleSheet.create(&#123;</span><br><span class="line">  icon: &#123;</span><br><span class="line">    width: <span class="number">24</span>,</span><br><span class="line">    height: <span class="number">24</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MyApp = DrawerNavigator(&#123;</span><br><span class="line">  Home: &#123;</span><br><span class="line">    screen: MyHomeScreen,</span><br><span class="line">  &#125;,</span><br><span class="line">  Notifications: &#123;</span><br><span class="line">    screen: MyNotificationsScreen,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>要打开和关闭抽屉导航器，分别导航到<code>DrawerOpen</code>和<code>DrawerClose</code>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerOpen'</span>); <span class="comment">// 打开抽屉导航器</span></span><br><span class="line"><span class="keyword">this</span>.props.navigation.navigate(<span class="string">'DrawerClose'</span>); <span class="comment">// 关闭抽屉导航器</span></span><br></pre></td></tr></table></figure>
<h2 id="API-定义"><a href="#API-定义" class="headerlink" title="API 定义"></a>API 定义</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DrawerNavigator(RouteConfigs, DrawerNavigatorConfig)</span><br></pre></td></tr></table></figure>
<h3 id="路由配置-RouteConfigs"><a href="#路由配置-RouteConfigs" class="headerlink" title="路由配置(RouteConfigs)"></a>路由配置(RouteConfigs)</h3><p>路由配置对象是从路由名称到路由配置的映射，它告诉导航器该路由的内容，请参阅<code>StackNavigator</code>中的示例。</p>
<h3 id="抽屉导航器配置-DrawerNavigatorConfig"><a href="#抽屉导航器配置-DrawerNavigatorConfig" class="headerlink" title="抽屉导航器配置(DrawerNavigatorConfig)"></a>抽屉导航器配置(DrawerNavigatorConfig)</h3><ul>
<li><code>drawerWidth</code> - 抽屉导航器的宽度</li>
<li><code>drawerPosition</code> - 选项：<code>left</code> 和 <code>right</code> ，默认的位置是左侧<code>left</code></li>
<li><code>contentComponent</code> - 用于呈现抽屉导航器内容的组件，例如导航项。接收抽屉导航器的 <code>navigation</code> 属性 。默认为<code>DrawerItems</code>。有关详细信息，请参阅下文。</li>
<li><code>contentOptions</code> - 配置抽屉导航器内容，见下文。</li>
</ul>
<h4 id="示例"><a href="#示例" class="headerlink" title="示例:"></a>示例:</h4><p>默认<code>DrawerView</code>不可滚动。要实现可滚动视图，您必须使用<code>contentComponent</code>自定义容器，如下面的示例所示。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  drawerWidth: <span class="number">200</span>,</span><br><span class="line">  drawerPosition: <span class="string">'right'</span>,</span><br><span class="line">  contentComponent: <span class="function"><span class="params">props</span> =&gt;</span> &lt;ScrollView&gt;<span class="xml"><span class="tag">&lt;<span class="name">DrawerItems</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span><span class="tag">&lt;/<span class="name">ScrollView</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>下面几个选项被传递到底层路由器来修改导航逻辑：</p>
<ul>
<li><code>initialRouteName</code> - 初始路由的routeName。</li>
<li><code>order</code> - 定义抽屉导航器项顺序的routeNames数组。</li>
<li><code>paths</code> -提供routeName到路径配置的映射，该配置将覆盖routeConfigs中设置的路径。</li>
<li><code>backBehavior</code> - 按下后退按钮是否会切换到初始路由？如果是，设置为<code>initialRoute</code>，否则为<code>none</code>。默认为<code>initialRoute</code>行为。</li>
</ul>
<h3 id="提供自定义的contentComponent"><a href="#提供自定义的contentComponent" class="headerlink" title="提供自定义的contentComponent"></a>提供自定义的<code>contentComponent</code></h3><p>您可以轻松地覆盖 <code>react-navigation</code>使用的默认组件：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; DrawerItems &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> CustomDrawerContentComponent = <span class="function">(<span class="params">props</span>) =&gt;</span> (</span><br><span class="line">  &lt;View style=&#123;style.container&#125;&gt;</span><br><span class="line">    &lt;DrawerItems &#123;...props&#125; /&gt;</span><br><span class="line">  &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const styles = StyleSheet.create(&#123;</span></span><br><span class="line"><span class="regexp">  container: &#123;</span></span><br><span class="line"><span class="regexp">    flex: 1,</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br></pre></td></tr></table></figure>
<h3 id="contentOptions-for-DrawerItems"><a href="#contentOptions-for-DrawerItems" class="headerlink" title="contentOptions for DrawerItems"></a><code>contentOptions</code> for <code>DrawerItems</code></h3><ul>
<li><code>items</code> - 路由数组，可以修改或覆盖</li>
<li><code>activeItemKey</code> -键确定活动路线</li>
<li><code>activeTintColor</code> - 活动标签的标题和图标颜色</li>
<li><code>activeBackgroundColor</code> -活动标签的背景颜色</li>
<li><code>inactiveTintColor</code> - 非活动标签的标签和图标颜色</li>
<li><code>inactiveBackgroundColor</code> - 非活动标签的背景颜色</li>
<li><code>onItemPress(route)</code> - 当按下项(Item)时调用的函数</li>
<li><code>style</code> - Item内容部分的样式对象</li>
<li><code>labelStyle</code> - 当您的标签是字符串时，此样式对象将覆盖内容部分中的文本样式</li>
</ul>
<h4 id="示例-1"><a href="#示例-1" class="headerlink" title="示例:"></a>示例:</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">contentOptions: &#123;</span><br><span class="line">  activeTintColor: <span class="string">'#e91e63'</span>,</span><br><span class="line">  style: &#123;</span><br><span class="line">    marginVertical: <span class="number">0</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="屏幕导航器选项-Screen-Navigation-Options"><a href="#屏幕导航器选项-Screen-Navigation-Options" class="headerlink" title="屏幕导航器选项(Screen Navigation Options)"></a>屏幕导航器选项(Screen Navigation Options)</h3><h4 id="title"><a href="#title" class="headerlink" title="title"></a><code>title</code></h4><p>可以用作<code>headerTitle</code>和<code>drawerLabel</code>的回退的通用标题</p>
<h4 id="drawerLabel"><a href="#drawerLabel" class="headerlink" title="drawerLabel"></a><code>drawerLabel</code></h4><p>字符串，React元素(组件)或赋予<code>{focused：boolean，tintColor：string}</code>的函数返回一个React元素(组件)，显示在抽屉导航器侧边栏中。未定义时，使用场景标题(<code>title</code>)</p>
<h4 id="drawerIcon"><a href="#drawerIcon" class="headerlink" title="drawerIcon"></a><code>drawerIcon</code></h4><p>React元素(组件)或一个函数，给定<code>{focused：boolean，tintColor：string}</code>返回一个React元素(组件)，显示在抽屉侧边栏中。</p>
<h3 id="导航器属性-Navigator-Props"><a href="#导航器属性-Navigator-Props" class="headerlink" title="导航器属性(Navigator Props)"></a>导航器属性(Navigator Props)</h3><p>由<code>DrawerNavigator（...）</code>创建的导航器组件具有以下属性：</p>
<ul>
<li><code>screenProps</code> - 向子屏幕传递额外的选项，例如：</li>
</ul>
 <figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> DrawerNav = DrawerNavigator(&#123;</span><br><span class="line">  <span class="comment">// 配置</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&lt;DrawerNav</span><br><span class="line">  screenProps=&#123;<span class="comment">/* 这个属性传递给子屏幕组件，在子屏幕组件中作为this.props.screenProps使用 */</span>&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<h3 id="Nesting-DrawerNavigation"><a href="#Nesting-DrawerNavigation" class="headerlink" title="Nesting DrawerNavigation"></a>Nesting <code>DrawerNavigation</code></h3><p>Please bear in mind that if you nest the DrawerNavigation, the drawer will show below the parent navigation.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://www.gravatar.com/avatar/c8b98e5df395f0e0fd3b47948b37b881.jpg?s=215"
               alt="William-Dream" />
          <p class="site-author-name" itemprop="name">William-Dream</p>
           
              <p class="site-description motion-element" itemprop="description">为了梦-追梦,我的英文名由此而来</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">83</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/li-jun-bo" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://www.lijunbo.com/" title="Net" target="_blank">Net</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">William-Dream</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("PWTRJaGA9VmnmuJISstgYQVk-gzGzoHsz", "OhMVXOeW5jbdIohUayYbpq1v");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

</body>
</html>
